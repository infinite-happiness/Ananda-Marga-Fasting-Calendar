<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="icon" href="favicon.ico">

    <title>Science</title>
    <style>
        .toc-list {
            padding-left: 20px;
        }
    </style>
</head>

<body>
    <header id="header" style="background:transparent;"></header>
    <script src="js/layout.js"></script>

    <main class="responsive padding main-content">
        <h1>Science of Ananda Marga Upavasa Fasting</h1>
        <div id="table-of-contents" class="margin"></div>
        <h2>Synopsis</h2>
        <p>
            AÌnanda MaÌrga upavaÌsa fasting dates are based on the Vedic solar day (sunrise to sunrise) which occur
            closest to the relevant lunar phases (ekaÌdashii ğŸŒ˜ ğŸŒ”, amaÌvasyaÌ/new moon ğŸŒ‘ and puÌrnÌimaÌ/full moon ğŸŒ•).
            The lunar phases are always the same around earth, and the their calculated values are quite consistent
            around the web. Sunrise however is something very complex to calculate, and needs to be defined properly in
            order to decide the correct fasting day.
        </p>
        <p>This software, the <strong><i class=""><img src="media/android-chrome-192x192.png"></i> AÌnanda MaÌrga
                Scientific Fasting Calendar (AMSFC, earlier named AMUFC)</strong>, uses scientic models for the
            calculations, and offers the possibility to use your position, time zone, and sunrise definition of choice,
            for calculating fasting days.
        </p>

        <h2>Methodology</h2>
        <p>
            Many of the technicalities for the fasting chart are explained on the
            <a class="yellow10-text" href="https://ampsnys.org/fasting-calendar/" target="_blank"
                rel="nofollow noopener">Ananda Marga â€“ New York Sector's website</a>.
        </p>

        <p> Here follows some quotes from that website:</p>
        <article class="yellow2">
            The actual fasting day is calculated to include most of the indicated lunar phase.
            Calculations follow the Indian convention of starting the days at dawn rather than midnight.
            These calculations for fasting dates are based on instructions given by Guru BÃ¡bÃ¡ to Ac. Jagadiishvarananda
            Avt. who was responsible for printing the Ananda Marga Diary. The Diary has always included the official
            fasting dates for Ananda Marga. Dada explained the system in 1976, reflected in the notes belowâ€¦
            For Ekadashi, (literally the 11th day after the new and full moons), we begin with the starting and ending
            times of the lunar day (...). The system is that the proper fasting day will be the solar day (from sunrise
            to sunrise) whose maximum time falls within the starting and ending times of the Ekadashi lunar day. The
            source data is based in Varanasi, India as per instruction by Guru BÃ¡bÃ¡.
            For those who fast on Purnima (full moon) and Amavasya (new moon), the same process is followed.
        </article>
        <!--<code> For those who do night meditation on the new moon, those calculations are also included (1st Night).</code>-->

        <h2>Moon Phases</h2>
        <p>The lunar month, including the moon phases new and full moon, can be described as degrees of a circle
            (although the true mathematical motion is elliptical, and more than 360Â°). Such a circle is illustrated
            in the video and image below:</p>
        <iframe loading="lazy" width="100%" height="480" style="max-width: 100%;"
            src="https://www.youtube.com/embed/LHD4Pk0D8_g?si=599DA-MDt9skYf4H" title="YouTube video player"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        <img src="media/phases-Moon-Earth-orbit.webp" style="width:100%;">

        <h2>Tithis</h2>
        <p>The relevant moon phases for Ananda Marga fasting are called tithis. <a class="yellow10-text"
                href="https://www.facebook.com/AnandaMargaGlobal/photos/a.294995040659306/531935473631927/?type=3&locale=en"
                target="_blank" rel="noopener nofollow">This Facebook post by Ananda Marga Global</a>
            describes the tithis and their relation to fasting:
        </p>
        <article class="yellow2">
            Ekadashi, also spelled as Ekadasi, is the eleventh lunar day (Tithi) of the shukla (bright) or krishna
            (dark) paksha (fortnight) of every lunar month. Shrii Shrii Anandamurtiji explained that as our body is a
            biological machine, the internal organs also need complete rest to recoup. Therefore, observing an ideally
            waterless fast from sunrise of the day of Ekadashi to sunrise on the next day is advocated. Two Ekadashis
            occur in one month according to positions of the moon. One Ekadashi coincides with the times when the Moon
            is the closest to Earth (perigee) and the times when it is farthest from the Earth (apogee). These are also
            the times of high tide and low tide respectively. These positions of the moon have effects on our physical
            bodies and our minds due to maximum gravitational or minimum gravitational pull by the moon. During
            Ekadashis in the Krishna paksha, the Moon is at its closest to the Earth and during Ekadashis in the Shukla
            paksha at its farthest from the Earth. Therefore, observance of fasts during these two positions of the moon
            in relation to the highest and lowest gravitational pull of the moon is scientific fasting for
            Grihis (Householders).
            Shrii Shrii Anandamurtiji, however, advocated two more additional days of waterless fasting for
            sanyasis (monks) and sanyasinis (nuns) of Ananda Marga Pracharaka Sangha i.e in Purnima (full moon)
            and Amavaisha (moonless period) also, (four days in a month) which will altogether constitute Spiritual
            Fasting. Every fast should be broken at sunrise with a glass of lemon water with salt which will help in
            cleansing of the gut by purgation. However, when the effects of purgation has been served, a couple of ripe
            bananas will serve to stop purgation. This should be followed by a bath, meditation and then light food.
        </article>
        <p>
            At the time of writing, you can see on
            the fasting chart on the <a class="yellow10-text" href="https://www.anandamarga.eu/fastingChart.php"
                target="_blank" rel="nofollow noopener">Official Website of Ananda Marga in Europe - Berlin
                Sector</a>,
            that the start and end times are based on tithis (specifically, the times of the tithis named ekaÌdashii,
            amaÌvasyaÌ and puÌrnÌimaÌ are displayed).
        </p>
        <p>Moon phases are always the same all over earth, and most tithi calculations around the web just
            differ with a few minutes of time (and are usually displayed in India Standard Time).
        </p>
        <h3>The Relevant Tithis for Ananda Marga Upavasa Fasting</h3>
        <ul class="margin">
            <li>EkaÌdashii (11 tithis/lunar days after new/full moon): occurs at angles 120Â° - 132Â° and 300Â° -
                312Â°</li>
            <li>AmaÌvasyaÌ (New Moon): occurs at angles 348Â° - 360Â°</li>
            <li>PuÌrnÌimaÌ (Full Moon): occurs at angles 168Â° - 180Â°</li>
        </ul>
        <p>When the tithis occur, and how long they are, are not that simple to calculate. Quite some knowledge
            of astromony and mathematics is required (or in the case of this software, the AMSFC, astronomical
            software libraries were used for the calculations. See <a class="yellow10-text" href="code.html">Code</a>.)
        </p>
        <h4>Understanding the Definitions of EkaÌdashii, AmaÌvasyaÌ, and PuÌrnÌimaÌ</h4>
        <p>Other than ekaÌdashii occuring 11 tithis after new/full moon, ekaÌdashii starts exactly 120Â° after
            the moment of new/full moon. That is exactly one third of the circled path the moon travels around earth.
            Furthemore, the start of ekaÌdashii until the moment of the upcoming new/full moon is exactly 60Â° of the
            moon's path around earth. So if you imagine the lunar path around earth forming a geometric shape in
            space, starting with ekaÌdashii and ending with new/full moon, a 60Â° arc is formed. If you let
            the arc start with new/full moon and end with the beginning ekaÌdashii, a 120Â° arc is formed.
        </p>
        <img src="media/Moon-Paths-Ekadashii-Amavasya-Purnima.svg">
        <p>AmaÌvasyaÌ and puÌrnÌimaÌ are lunar days which end at the moment of new/full moon respectively.</p>
        More about 60Â° angles:
        <ul class="margin">
            <li>60Â° angles are found in equilateral triangles and the unit circle in trigonometry.</li>
            <li>The unit circle is a fundamental tool in astronomy because of its connection to trigonometry.
            </li>
            <li>The pratik consists of two equilateral triangles.</li>
        </ul>
        <h3>WikiPedia on Tithis:</h3>
        <article class="yellow2">
            In Vedic timekeeping, a tithi is a "duration of two faces of moon that is observed from earth", known as
            milĞ°Ì„lyĞ°Ì„ (Newar: ğ‘©ğ‘¶ğ‘®ğ‘µğ‘®ğ‘‘‚ğ‘«ğ‘µğ‘‘…, à¤®à¤¿à¤²à¤¾à¤²à¥à¤¯à¤¾à¤ƒ) in Nepal Bhasa, or the time it takes for the longitudinal
            angle between the Moon and the Sun to increase by 12Â°. In other words, a tithi is a time duration between
            the consecutive epochs that correspond to when the longitudinal angle between the Sun and the Moon is an
            integer multiple of 12Â°. Tithis begin at varying times of day and vary in duration approximately from 19 to
            26 hours. Every day of a lunar month is called tithi.
        </article><br>
        <img src="media/Tithi_Calculation.jpg" style="width:100%;" />
        <video width="100%" height="45%" controls>
            <source src="media/Tithi.ogv.480p.vp9.webm" type="video/mp4">
            Your browser does not support the video tag.
        </video>
        <br>
        The astronomical basis of the Hindu lunar day.
        <br />
        <small>The image (credit: User:Freedomji) and video above are taken from Wikipedia.</small>
        <p>Read more about <a class="yellow10-text" href="https://en.wikipedia.org/wiki/Tithi" target="_blank"
                rel="nofollow noopener">tithis on
                WikiPedia</a>.</p>

        <h3>Calculating Fasting Dates Without Tithis</h3>
        <p>
            This is just an idea that could be used as an alternative method if ever needed. Since it's easier
            to find programming libraries that calculate dawn, new moon and full moon, an alternative method to
            get a fasting date could be to get the geocentric phase angle at the sunrises/dawns that occur near the
            tithis.
        </p>
        <p>
            This way you wouldn't calculate the time which the tithi spans over the solar day, but instead which
            angle the sunrises near the tithi has. You can then calculate which solar day is the closest to the tithi
            by angular comparison, rather than time span.
        </p>
        <article class="yellow2">
            For example, suppose sunrise<sub>1</sub> is when the lunar phase is 130Â°. This means the sunrise<sub>1</sub>
            is during EkaÌdashii (120Â° - 132Â°). Sunrise<sub>0</sub> is at lunar phase 118Â°, and sunrise<sub>2</sub> is
            at lunar phase 142Â°.
            The day between sunrise<sub>0</sub> and sunrise<sub>1</sub> spans over the lunar phase between 118Â° and
            130Â°, and 8Â° of those are during EkaÌdashii.
            The day between sunrise<sub>1</sub> and sunrise<sub>2</sub> spans over the lunar phase between 130Â° and
            142Â°, and 2Â° of those are during EkaÌdashii.
            So the conclusion is that the day between sunrise<sub>0</sub> and sunrise<sub>1</sub> is the fasting day,
            since 8Â° is larger than 2Â°.
        </article>

        <h2>Dawn and Sunrise</h2>
        <p>Ananda Marga's fasting system uses the Vedic solar day to determine the date of a day. In some ways
            it's natural to think of the day starting in the morning. The day actually starts in the morning
            (when most people wake up), rather than in the middle of the night (when most people are asleep, or have
            not even gone to bed yet). However, there are number of problems that arise when using sunrise as the
            start and end of the day.
        </p>
        <h3>Issues of Calculating Sunrise and Dawn</h3>
        <ul class="margin">
            <li>
                The day starts at a different time every day, and needs to be calculated.
            </li>
            <li>The day starts at different times in different locations and elevations above sea level - even
                when those locations are within the same time zone. The accuracy of the position also affects
                calculations.
            </li>
            <li>The definition of sunrise differ from place to place, even within the Vedic community (see <a
                    class="yellow10-text"
                    href="https://www.quora.com/In-Hindu-culture-does-the-new-day-start-at-12-00-AM" target="_blank"
                    rel="nofollow noopener">this discussion</a>
                and <a class="yellow10-text"
                    href="https://www.quora.com/At-what-time-does-a-day-start-according-to-the-Hindu-calendar"
                    target="_blank" rel="nofollow noopener">this one</a>). This has a rather big impact on
                calculating the fasting day, since the choice of sunrise definition sometimes moves the fasting day from
                one day to another.</li>
            <li>Sometimes, in some places (far north and far south), during summer and winter, there are no
                sunrises. Namely during midnight sun and polar night (or depending on the definition of sunrise,
                a larger part of the world).</li>
            <li>Atmospheric refraction, which causes celestial bodies to appear higher above the horizon than
                they would if the Earth had no atmosphere.</li>
        </ul>

        <h3>Defining Sunrise</h3>
        <p>To get the Ananda Marga fasting system correct, we need to define the following:</p>
        <ul class="margin">
            <li>What is a sunrise? In other words, when exactly does the solar day start? At what position of
                the sun?
            </li>
            <li>What is a sunrise during midnight sun and polar night? In other words, what happens when the
                defined position of sunrise does not occur, because it is not reached certain days of the year?</li>
        </ul>
        <p>Sunrise should probably be astronomical, nautical or civil dawn (see illustration below), or when the
            top of the sun peeks above the horizon.</p>

        <h3>Calculating Sunrise </h3>
        <p>These values are used for calculating sunrise/dawn:</p>
        <ul class="margin">
            <li>Date and time</li>
            <li>Latitude and Longitude</li>
            <li>Elevation of the location above sea level</li>
            <li>Height above ground (depending on the definition of sunrise). This height is above the
                elevation, for example considering the height of a person, and their position (sitting or standing, on
                the ground or at the top of a skyscraper).</li>
        </ul>

        <p>There are different concepts of dawn and sunrise in modern science. On the illustration below you can
            see that the sun is below the horizon during different twilights, and in the center of the horizon
            at sunrise. The beginning of these twilights are sometimes refered to as dawn (astronomical, nautical
            and civil dawn).
        </p>
        <img src="media/sun-position-sunrise-dawn.webp" />
        <small>Credit: ASTRONOMY: ROEN KELLY, after Aurora Borealis Observatory</small>

        <h3>Comparisons With Other Published Calendars</h3>
        <p>The fasting dates on different Ananda Marga websites on the web are different. However, some of them
            use the exact same dates, although they are in different time zones:</p>
        <ul class="margin">
            <li><a class="yellow10-text" href="https://www.anandamarga.eu/fastingChart.php" target="_blank"
                    rel="nofollow noopener">Official Website of Ananda Marga in Europe - Berlin Sector</a></li>
            <li><a class="yellow10-text" href="https://india.anandamarga.org/fasting-calendar/" target="_blank"
                    rel="nofollow noopener">Ananda Marga India - Delhi Sector</a>
            </li>
            <li><a class="yellow10-text" href="https://hks.amps.org/fasting-chart/" target="_blank"
                    rel="nofollow noopener">Ananda Marga Hong Kong Sector</a>
            </li>
        </ul>
        <p>
            The fasting dates on the above web sites all correspond to the table below, and are on this website
            considered the official fasting dates (see table below). These dates were compared to the
            calculations of this software (AMSFC). It can be concluded with high probability that the tithi times are
            based on Asia/Kolkata (Varanasi) time zone. The fasting dates are most probably also based on the sunrises
            of Varanasi.
        </p>
        <h4>Different Types of Dawn - and Coordinates of Varanasi</h4>
        <p>
            Comparisons were made using sunrise and the different types of dawn. There were also different
            values for latitude and longitude for Varanasi online. However, the latitude and longitude coordinates
            didn't have much effect on the choice of fasting dates.
        </p>
        <p>The highest accuracy when comparing different implementations of AMSFC with the official dates were:
        </p>
        <ul class="margin">
            <li>Civil Dawn (6Â°): 90%</li>
            <li>Sun at the Center of the Horizon (0Â°): 88%</li>
            <li>Top of the Sun Peeks Above the Horizon: 88%</li>
            <li>Nautical Dawn (12Â°): 88%</li>
            <li>Astronomical Dawn (18Â°): 82%</li>
        </ul>
        <h5>AMSFC's Definition of Sunrise</h5>
        <p>
            Since civil dawn once had the highest accuracy it is selected as default in the calendar, and the
            definition of sunrise. It's difficult to achieve a higher accuracy without knowing the exact tools that were
            used for finding the official dates.
        </p>
        <h4>Differences</h4>
        <p>
            The reasons 100% accuracy wasn't achieved was probably:
        </p>
        <ul class="margin">
            <li>The calculations of tithis and sunrise are not exactly the same, and the exact location used for
                the calculations might not be the same. Usually the difference is small, and still the chosen
                fasting day is different. This is because as the tithi spans similarly over both two solar day
                candidates, and small details will decide which of the candidates gets chosen.
            </li>
            <li>Some of the official fasting days are probably miscalculated (because of human error).</li>
            <li>There might be errors in the AMSFC.</li>
        </ul>

        <h5>Example - Calculation Difference</h5>
        Here you can see that the chosen dates depend on a few minutes of time, so it's understandable why
        different
        calculations will result in different fasting days.
        <article class="yellow2">
            PuÌrnÌimaÌ starts: Saturday 20 July 2024 at 18:00 India Standard Time<br>
            Then: 10h 54m 16s until...<br>
            Sunrise: Sunday 21 July 2024 at 04:54 India Standard Time<br>
            Sunrise type: Civil Dawn 6Â°<br>
            Then: 10h 52m 52s until...<br>
            PuÌrnÌimaÌ ends: Sunday 21 July 2024 at 15:47 India Standard Time<br>
            Official fasting date: 2024-07-21
        </article>

        <h5>Example - Human Error</h5>
        This official fasting date was never chosen by any implementation of the AMSFC, and the choise of
        fasting date is clear. PuÌrnÌimaÌ spans over the 24th for a much longer time than the 25th. So the officially
        chosen date may be a mistake.
        <article class="yellow2">
            PuÌrnÌimaÌ starts: Sunday 24 March 2024 at 09:56 India Standard Time<br>
            Then: 19h 37m 27s until...<br>
            Sunrise: Monday 25 March 2024 at 05:33 India Standard Time<br>
            Sunrise type: Civil Dawn 6Â°<br>
            Then: 6h 57m 15s until...<br>
            PuÌrnÌimaÌ ends: Monday 25 March 2024 at 12:31 India Standard Time<br>
            Official fasting date: 2024-03-25
        </article>
        <br>

        <img src="media/fasting_2024_1.png" />
        <img src="media/fasting_2024_2.png" />

        <h2>Accuracy of the Ananda Marga Fasting Calendar (AMSFC)</h2>
        <p>This software is based on <a class="yellow10-text" href="https://github.com/cosinekitty/astronomy/"
                target="_blank" rel="nofollow noopener">Astronomy Engine</a>, a software engine accurate to
            within Â±1
            arcminute (<sup>1</sup>&frasl;<sub>60th</sub> of a degree). It is based on the authoritative and
            well-tested
            models <a class="yellow10-text" href="https://en.wikipedia.org/wiki/VSOP_model" target="_blank"
                rel="nofollow noopener">VSOP87</a> and <a class="yellow10-text"
                href="https://aa.usno.navy.mil/software/novasc_intro" target="_blank" rel="nofollow noopener">NOVAS C
                3.1.</a>
        </p>
        <p>These models determine the precise positions of celestial bodies like stars, planets, the Moon, and
            the Sun at a given time. However, sunrise is influenced by additional factors beyond its exact position.
            Sunrise is affected by the atmosphere which refracts sunlight, causing the Sun to appear slightly higher
            above the horizon than it actually is. This affects the exact timing of sunrise and sunset.
            Also, sunrise depends on your location on Earth.
        </p>
        <p>Atmospheric refraction, which causes celestial bodies to appear higher above the horizon than they
            would if the Earth had no atmosphere. Astronomy Engine uses a correction of 34 arcminutes. Real-world
            refraction varies based on air temperature, pressure, and humidity, which are not taken into
            account.</p>
        <h3>Einstein's Theory of Relativity</h3>
        <p>Einstein's theory of relativity does have some subtle effects on the motion of celestial bodies,
            including the Moon. One effect is called relativistic precession, which causes the Moon's orbit to slowly
            wobble over time. However, the magnitude of these relativistic effects is incredibly small. They have a
            negligible impact on the overall geometry of the Earth-Sun-Moon system, which determines the Moon's phases.
            For most astronomical applications, including calculating lunar phases, the influence of relativity is
            insignificant. The high precision of models like VSOP (within 1 arcsecond for thousands of years) already
            accounts for the vast majority of the Moon's motion.</p>
        <p>The impact of relativity on sunrise and dawn calculations is also negligible for most purposes. Due
            to Earth's rotation, different parts of the Earth experience slightly different gravitational
            strengths. According to relativity, time runs slower in weaker gravity. This effect is minuscule but can
            cause a slight time difference in sunrise depending on your location. Gravity can bend light slightly. This
            effect is extremely weak, but it can theoretically cause the Sun to appear a tiny bit higher above the
            horizon during sunrise and sunset compared to a purely Newtonian calculation.</p>
        <h3>Higher Accuracy</h3>
        <p>To achieve higher accuracy, the exact location for the observation of the sunrise has to be used, as
            well as a definition of what counts as sunrise. Perhaps these methods could be used for higher accuracy in
            sunrise and tithi calculations: </p>
        <ul class="margin">
            <li>
                <a class="yellow10-text" href="https://github.com/variar/elp2000-82b" target="_blank"
                    rel="nofollow noopener">https://github.com/variar/elp2000-82b</a>

            </li>
            <li>
                Eclipse Predictions by Fred Espenak: This model provides highly accurate predictions for lunar
                phases and eclipses, taking into account various perturbations and corrections.
            </li>
            <li>Solar and Lunar Almanac (SAA): This model includes detailed algorithms for calculating sunrise
                and sunset times, considering the Earthâ€™s axial tilt and orbital eccentricity. NOAA Solar
                Calculator: The National Oceanic and Atmospheric Administration provides a solar calculator that
                accounts for atmospheric refraction and other factors to give precise sunrise and sunset times. These
                models incorporate more detailed corrections and perturbations, making them suitable for high-precision
                astronomical calculations.</li>
            <li><a class="yellow10-text"
                    href="https://www.researchgate.net/publication/228789607_Comparison_between_high_precision_precession_models_for_the_ecliptic_and_the_equator"
                    target="_blank"
                    rel="nofollow noopener">https://www.researchgate.net/publication/228789607_Comparison_between_high_precision_precession_models_for_the_ecliptic_and_the_equator</a>
            </li>
        </ul>

        <h2>Conclusion</h2>
        <p>
            The default position of Varanasi is taken from <a class="yellow10-text"
                href="https://en.wikipedia.org/wiki/Varanasi" target="_blank" rel="nofollow noopener">WikiPedia:</a>
            latitude: 25.318889, longitude: 83.012778 and elevation: 80.71.
        </p>
        <p>The default start of day is set to civil dawn.</p>

        <h2>Appendix</h2>
        <h3>First Night</h3>
        The midnight that falls during the start and end tithi times of amaÌvasyaÌ is 2nd night. Therefore, normally the
        first night occurs the night before amaÌvasyaÌ.

        <h3>Unicode Lunar Phases</h3>
        For the ekaÌdashii phases the symbols are not exactly correct, but still used as indications.
        <article class="yellow2">
            <pre>
            U+1F311 | ğŸŒ‘ | f0 9f 8c 91 | NEW MOON SYMBOL
            U+1F312 | ğŸŒ’ | f0 9f 8c 92 | WAXING CRESCENT MOON SYMBOL
            U+1F313 | ğŸŒ“ | f0 9f 8c 93 | FIRST QUARTER MOON SYMBOL
            U+1F314 | ğŸŒ” | f0 9f 8c 94 | WAXING GIBBOUS MOON SYMBOL
            U+1F315 | ğŸŒ• | f0 9f 8c 95 | FULL MOON SYMBOL
            U+1F316 | ğŸŒ– | f0 9f 8c 96 | WANING GIBBOUS MOON SYMBOL
            U+1F317 | ğŸŒ— | f0 9f 8c 97 | LAST QUARTER MOON SYMBOL
            U+1F318 | ğŸŒ˜ | f0 9f 8c 98 | WANING CRESCENT MOON SYMBOL

            Unicode sunrise/sunset:
            U+263C | â˜¼ | e2 98 bc | WHITE SUN WITH RAYS
            U+2600 | â˜€ | e2 98 80 | BLACK SUN WITH RAY
        </pre>
        </article>
        Source: https://github.com/lfos/calcurse/issues/307

        <div id="bottom_content"></div>
    </main>

    <script src="js/tocbot.min.js"></script>
    <script>
        // https://github.com/tscanlin/tocbot/blob/master/src/utils/make-ids.js
        function makeIds() {
            console.log("making ids");
            var content = document.querySelector('.main-content')
            var headings = content.querySelectorAll('h1, h2, h3, h4, h5, h6, h7')
            var headingMap = {}

            Array.prototype.forEach.call(headings, function (heading) {
                var id = heading.id
                    ? heading.id
                    : heading.innerText.trim().toLowerCase().replace(/\s+/g, '-').replace(/[^a-z0-9-]/g, '')
                headingMap[id] = !isNaN(headingMap[id]) ? ++headingMap[id] : 0
                if (headingMap[id]) {
                    heading.id = id + '-' + headingMap[id]
                } else {
                    heading.id = id
                }
            })
        }
        makeIds();

        tocbot.init({
            // Where to render the table of contents.
            tocSelector: '#table-of-contents',
            // Where to grab the headings to build the table of contents.
            contentSelector: '.main-content',
            // Which headings to grab inside of the contentSelector element.
            headingSelector: 'h2, h3, h4, h5, h6, h7',
            // For headings inside relative or absolute positioned containers within content.
            hasInnerContainers: true,
            linkClass: 'yellow10-text',
            scrollSmoothOffset: -100,
            headingsOffset: 100,
            orderedList: true,
        });
    </script>
</body>

</html>